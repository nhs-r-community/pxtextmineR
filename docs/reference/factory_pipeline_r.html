<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prepare and fit a text classification pipeline — factory_pipeline_r • pxtextmineR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Prepare and fit a text classification pipeline — factory_pipeline_r" />
<meta property="og:description" content="Prepare and fit a text classification pipeline with
Scikit-learn." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pxtextmineR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare and fit a text classification pipeline</h1>
    
    <div class="hidden name"><code>factory_pipeline_r.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prepare and fit a text classification pipeline with
<a href='https://scikit-learn.org/stable/index.html'><code>Scikit-learn</code></a>.</p>
    </div>

    <pre class="usage"><span class='fu'>factory_pipeline_r</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  tknz <span class='op'>=</span> <span class='st'>"spacy"</span>,
  ordinal <span class='op'>=</span> <span class='cn'>FALSE</span>,
  metric <span class='op'>=</span> <span class='st'>"class_balance_accuracy_score"</span>,
  cv <span class='op'>=</span> <span class='fl'>5</span>,
  n_iter <span class='op'>=</span> <span class='fl'>2</span>,
  n_jobs <span class='op'>=</span> <span class='fl'>1</span>,
  verbose <span class='op'>=</span> <span class='fl'>3</span>,
  learners <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SGDClassifier"</span>, <span class='st'>"RidgeClassifier"</span>, <span class='st'>"Perceptron"</span>,
    <span class='st'>"PassiveAggressiveClassifier"</span>, <span class='st'>"BernoulliNB"</span>, <span class='st'>"ComplementNB"</span>, <span class='st'>"MultinomialNB"</span>,
    <span class='st'>"RandomForestClassifier"</span><span class='op'>)</span>,
  theme <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A data frame with the text feature.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A vector with the response variable.</p></td>
    </tr>
    <tr>
      <th>tknz</th>
      <td><p>Tokenizer to use ("spacy" or "wordnet").</p></td>
    </tr>
    <tr>
      <th>ordinal</th>
      <td><p>Whether to fit an ordinal classification model. The ordinal
model is the implementation of <a href='https://www.cs.waikato.ac.nz/~eibe/pubs/ordinal_tech_report.pdf'>Frank and Hall (2001)</a>
that can use any standard classification model that calculates
probabilities.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>A string. Scorer to use during pipeline tuning
("accuracy_score", "balanced_accuracy_score", "matthews_corrcoef",
"class_balance_accuracy_score").</p></td>
    </tr>
    <tr>
      <th>cv</th>
      <td><p>Number of cross-validation folds.</p></td>
    </tr>
    <tr>
      <th>n_iter</th>
      <td><p>Number of parameter settings that are sampled (see
<a href='https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html'><code>sklearn.model_selection.RandomizedSearchCV</code></a>).</p></td>
    </tr>
    <tr>
      <th>n_jobs</th>
      <td><p>Number of jobs to run in parallel (see <code>sklearn.model_selection.RandomizedSearchCV</code>).
<strong>NOTE:</strong> If your machine does not have the number of cores specified in
<code>n_jobs</code>, then an error will be returned.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Controls the verbosity (see <code>sklearn.model_selection.RandomizedSearchCV</code>).</p></td>
    </tr>
    <tr>
      <th>learners</th>
      <td><p>A vector of <code>Scikit-learn</code> names of the learners to tune. Must
be one or more of "SGDClassifier", "RidgeClassifier", "Perceptron",
"PassiveAggressiveClassifier", "BernoulliNB", "ComplementNB",
"MultinomialNB", "KNeighborsClassifier", "NearestCentroid",
"RandomForestClassifier". When a single model is used, it can be passed as
a string.</p></td>
    </tr>
    <tr>
      <th>theme</th>
      <td><p>For internal use by Nottinghamshire Healthcare NHS Foundation
Trust or other trusts that use theme labels ("Access",
"Environment/ facilities" etc.). The column name of the theme variable.
Defaults to <code>NULL</code>. If supplied, the theme variable will be used as a
predictor (along with the text predictor) in the model that is fitted
with criticality as the response variable. The rationale is two-fold.
First, to help the model improve predictions on criticality when the
theme labels are readily available. Second, to force the criticality for
"Couldn't be improved" to always be "3" in the training and test data, as
well as in the predictions. This is the only criticality value that
"Couldn't be improved" can take, so by forcing it to always be "3", we
are improving model performance, but are also correcting possible
erroneous assignments of values other than "3" that are attributed to
human error.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A fitted <code>Scikit-learn</code> pipeline containing a number of objects that
can be accessed with the <code><a href='https://rdrr.io/r/base/Extract.html'>$</a></code> sign (see examples). For a partial list see
"Atributes" in <a href='https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html'><code>sklearn.model_selection.RandomizedSearchCV</code></a>.
Do not be surprised if more objects are in the pipeline than those in the
aforementioned "Attributes" list. Python objects can contain a wide array
of objects, from numeric results (e.g. the pipeline's accuracy),
to <em>methods</em> (i.e. functions in the R lingo) and <em>classes</em>. In Python,
these are normally accessed with <code>object.&lt;whatever&gt;</code>, but in R the
command is <code>object$&lt;whatever&gt;</code>. For instance, one can access method
<code><a href='https://rdrr.io/r/stats/predict.html'>predict()</a></code> to make predictions on unseen data. See examples.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The pipeline's parameter grid switches between two approaches to text
classification: Bag-of-Words and Embeddings. For the former, both TF-IDF and
raw counts are tried out.</p>
<p>The pipeline does the following:</p>
<ul>
<li><p>Feature engineering:
<ul>
<li><p>Converts text into TF-IDFs or <a href='https://nlp.stanford.edu/projects/glove/'><code>GloVe</code></a>
word vectors with <a href='https://spacy.io/'><code>spaCy</code></a>.</p></li>
<li><p>Creates a new feature that is the length of the text in
each record.</p></li>
<li><p>Performs sentiment analysis on the text feature and creates
new features that are all scores/indicators produced by
<a href='https://textblob.readthedocs.io/en/dev/'><code>TextBlob</code></a>
and <a href='https://pypi.org/project/vaderSentiment/'><code>vaderSentiment</code></a>.</p></li>
<li><p>Applies <a href='https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.KBinsDiscretizer.html'><code>sklearn.preprocessing.KBinsDiscretizer</code></a>
to the text length and sentiment indicator features, and
<a href='https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html'><code>sklearn.preprocessing.StandardScaler</code></a>
to the embeddings (word vectors).</p></li>
</ul></p></li>
<li><p>Up-sampling of rare classes: uses <a href='https://imbalanced-learn.org/stable/references/generated/imblearn.over_sampling.RandomOverSampler.html#imblearn.over_sampling.RandomOverSampler'><code>imblearn.over_sampling.RandomOverSampler</code></a>
to up-sample rare classes. Currently the threshold to consider a
class as rare and the up-balancing values are fixed and cannot be
user-defined.</p></li>
<li><p>Tokenization and lemmatization of the text feature: uses <code>spaCy</code>
(default) or <a href='https://www.nltk.org/'><code>NLTK</code></a>. It also strips
punctuation, excess spaces, and metacharacters "r" and "n" from the
text. It converts emojis into <code>"__text__"</code> (where "text" is the emoji
name), and NA/NULL values into <code>"__notext__"</code> (the pipeline does get
rid of records with no text, but this conversion at least deals with
any escaping ones).</p></li>
<li><p>Feature selection: Uses <a href='https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectPercentile.html'><code>sklearn.feature_selection.SelectPercentile</code></a>
with <a href='https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.chi2.html#sklearn.feature_selection.chi2'><code>sklearn.feature_selection.chi2</code></a>
for TF-IDFs or <a href='https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.f_classif.html#sklearn-feature-selection-f-classif'><code>sklearn.feature_selection.f_classif</code></a>
for embeddings.</p></li>
<li><p>Fitting and benchmarking of user-supplied <code>Scikit-learn</code>
<a href='https://scikit-learn.org/stable/modules/classes.html'>estimators</a>.</p></li>
</ul>

<p>The numeric values in the grid are currently lists/tuples (Python objects) of
values that are defined either empirically or are based on the published
literature (e.g. for Random Forest, see <a href='https://arxiv.org/abs/1802.09596'><code>Probst et al. 2019</code></a>).
Values may be replaced by appropriate distributions in a future release.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The pipeline uses the tokenizers of <code>Python</code> library <code>pxtextmining</code>.
Any warnings from <code>Scikit-learn</code> like <code>UserWarning: The parameter 'token_pattern' will not be used since 'tokenizer' is not None'</code> can
therefore be safely ignored.<br /><br />
Also, any warnings about over-sampling can also be safely ignored. These
warnings are simply a result of an internal check in the over-sampler of
<a href='https://imbalanced-learn.org/stable/install.html'><code>imblearn</code></a>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Frank E. &amp; Hall M. (2001). A Simple Approach to Ordinal Classification.
<em>Machine Learning: ECML 2001</em> 145--156.</p>
<p>Pedregosa F., Varoquaux G., Gramfort A., Michel V., Thirion B., Grisel O.,
Blondel M., Prettenhofer P., Weiss R., Dubourg V., Vanderplas J., Passos A.,
Cournapeau D., Brucher M., Perrot M. &amp; Duchesnay E. (2011),
<a href='https://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html'>Scikit-learn: Machine Learning in Python</a>.
<em>Journal of Machine Learning Research</em> 12:2825–-2830.</p>
<p>Probst P., Bischl B. &amp; Boulesteix A-L (2018). Tunability: Importance of
Hyperparameters of Machine Learning Algorithms.
<a href='https://arxiv.org/abs/1802.09596'>https://arxiv.org/abs/1802.09596</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Prepare training and test sets</span>
<span class='va'>data_splits</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'><a href='factory_data_load_and_split_r.html'>factory_data_load_and_split_r</a></span><span class='op'>(</span>
  filename <span class='op'>=</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='va'><a href='text_data.html'>text_data</a></span>,
  target <span class='op'>=</span> <span class='st'>"label"</span>,
  predictor <span class='op'>=</span> <span class='st'>"feedback"</span>,
  test_size <span class='op'>=</span> <span class='fl'>0.90</span><span class='op'>)</span> <span class='co'># Make a small training set for a faster run in this example</span>

<span class='co'># Let's take a look at the returned list</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>data_splits</span><span class='op'>)</span>
</div><div class='output co'>#&gt; List of 6
#&gt;  $ x_train    :'data.frame':	929 obs. of  1 variable:
#&gt;   ..$ predictor: chr [1:929] "Staff was nice." "A bit difficult to understand the staff when they talk to you wearing masks.  Have lost a few items since I been here as well." "There were odd things that I found disturbing" "Nothing" ...
#&gt;   ..- attr(*, "pandas.index")=Int64Index([1116, 6904, 6642, 8361, 2488, 7989, 1716, 2237, 5699, 3859,
#&gt;             ...
#&gt;             3891, 7769, 2108, 4564, 4055,  682,  647, 4854, 3162, 7381],
#&gt;            dtype='int64', length=929)
#&gt;  $ x_test     :'data.frame':	8362 obs. of  1 variable:
#&gt;   ..$ predictor: chr [1:8362] "Nothing all good" "Nothing" "No problems, felt looked after" "Rob, amazing mental health practitioner. Very kind, understand." ...
#&gt;   ..- attr(*, "pandas.index")=Int64Index([8593, 6048, 5986,  859, 6784, 2277, 1378, 3834, 4280, 9275,
#&gt;             ...
#&gt;             2161, 4236, 4514, 2251, 5990, 2676, 1207, 2797, 3007, 2741],
#&gt;            dtype='int64', length=8362)
#&gt;  $ y_train    : Named chr [1:929] "Staff" "Communication" "Care received" "Couldn't be improved" ...
#&gt;   ..- attr(*, "names")= chr [1:929] "1116" "6904" "6642" "8361" ...
#&gt;  $ y_test     : Named chr [1:8362] "Couldn't be improved" "Couldn't be improved" "Miscellaneous" "Staff" ...
#&gt;   ..- attr(*, "names")= chr [1:8362] "8593" "6048" "5986" "859" ...
#&gt;  $ index_train: int [1:929] 1116 6904 6642 8361 2488 7989 1716 2237 5699 3859 ...
#&gt;  $ index_test : int [1:8362] 8593 6048 5986 859 6784 2277 1378 3834 4280 9275 ...</div><div class='input'>
<span class='co'># Fit the pipeline</span>
<span class='va'>pipe</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'>factory_pipeline_r</span><span class='op'>(</span>
  x <span class='op'>=</span> <span class='va'>data_splits</span><span class='op'>$</span><span class='va'>x_train</span>,
  y <span class='op'>=</span> <span class='va'>data_splits</span><span class='op'>$</span><span class='va'>y_train</span>,
  tknz <span class='op'>=</span> <span class='st'>"spacy"</span>,
  ordinal <span class='op'>=</span> <span class='cn'>FALSE</span>,
  metric <span class='op'>=</span> <span class='st'>"accuracy_score"</span>,
  cv <span class='op'>=</span> <span class='fl'>2</span>, n_iter <span class='op'>=</span> <span class='fl'>1</span>, n_jobs <span class='op'>=</span> <span class='fl'>1</span>, verbose <span class='op'>=</span> <span class='fl'>3</span>,
  learners <span class='op'>=</span> <span class='st'>"SGDClassifier"</span>
<span class='op'>)</span>

<span class='co'># Mean cross-validated score of the best_estimator</span>
<span class='va'>pipe</span><span class='op'>$</span><span class='va'>best_score_</span>
</div><div class='output co'>#&gt; [1] 0.4154431</div><div class='input'>
<span class='co'># Best parameters during tuning</span>
<span class='va'>pipe</span><span class='op'>$</span><span class='va'>best_params_</span>
</div><div class='output co'>#&gt; $sampling__kw_args
#&gt; $sampling__kw_args$up_balancing_counts
#&gt; [1] 300
#&gt; 
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__use_idf
#&gt; [1] FALSE
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__tokenizer
#&gt; &lt;pxtextmining.helpers.tokenization.LemmaTokenizer&gt;
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__preprocessor
#&gt; &lt;function text_preprocessor at 0x0000000063EB9F70&gt;
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__norm
#&gt; NULL
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__ngram_range
#&gt; $preprocessor__texttr__text__transformer__ngram_range[[1]]
#&gt; [1] 3
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__ngram_range[[2]]
#&gt; [1] 3
#&gt; 
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__min_df
#&gt; [1] 1
#&gt; 
#&gt; $preprocessor__texttr__text__transformer__max_df
#&gt; [1] 0.95
#&gt; 
#&gt; $preprocessor__texttr__text__transformer
#&gt; TfidfVectorizer(max_df=0.95, ngram_range=(3, 3), norm=None,
#&gt;                 preprocessor=&lt;function text_preprocessor at 0x0000000063EB9F70&gt;,
#&gt;                 tokenizer=&lt;pxtextmining.helpers.tokenization.LemmaTokenizer&gt;,
#&gt;                 use_idf=False)
#&gt; 
#&gt; $preprocessor__sentimenttr__scaler__scaler__n_bins
#&gt; [1] 8
#&gt; 
#&gt; $preprocessor__sentimenttr__scaler__scaler
#&gt; KBinsDiscretizer(n_bins=8, strategy='kmeans')
#&gt; 
#&gt; $preprocessor__lengthtr__scaler__scaler
#&gt; KBinsDiscretizer(n_bins=3, strategy='kmeans')
#&gt; 
#&gt; $featsel__selector__score_func
#&gt; &lt;function chi2 at 0x0000000063E86C10&gt;
#&gt; 
#&gt; $featsel__selector__percentile
#&gt; [1] 100
#&gt; 
#&gt; $featsel__selector
#&gt; SelectPercentile(percentile=100,
#&gt;                  score_func=&lt;function chi2 at 0x0000000063E86C10&gt;)
#&gt; 
#&gt; $clf__estimator__penalty
#&gt; [1] "elasticnet"
#&gt; 
#&gt; $clf__estimator__max_iter
#&gt; [1] 10000
#&gt; 
#&gt; $clf__estimator__loss
#&gt; [1] "log"
#&gt; 
#&gt; $clf__estimator__class_weight
#&gt; NULL
#&gt; 
#&gt; $clf__estimator
#&gt; SGDClassifier(loss='log', max_iter=10000, penalty='elasticnet')
#&gt; </div><div class='input'>
<span class='co'># Make predictions</span>
<span class='va'>preds</span> <span class='op'>&lt;-</span> <span class='va'>pipe</span><span class='op'>$</span><span class='fu'>predict</span><span class='op'>(</span><span class='va'>data_splits</span><span class='op'>$</span><span class='va'>x_test</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>preds</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Couldn't be improved" "Couldn't be improved" "Care received"       
#&gt; [4] "Staff"                "Staff"                "Staff"               </div><div class='input'>
<span class='co'># Performance on test set #</span>
<span class='co'># Can be done using the pipe's score() method</span>
<span class='va'>pipe</span><span class='op'>$</span><span class='fu'>score</span><span class='op'>(</span><span class='va'>data_splits</span><span class='op'>$</span><span class='va'>x_test</span>, <span class='va'>data_splits</span><span class='op'>$</span><span class='va'>y_test</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.485171</div><div class='input'>
<span class='co'># Or using dplyr</span>
<span class='va'>data_splits</span><span class='op'>$</span><span class='va'>y_test</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>true <span class='op'>=</span> <span class='st'>'.'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    pred <span class='op'>=</span> <span class='va'>preds</span>,
    check <span class='op'>=</span> <span class='va'>true</span> <span class='op'>==</span> <span class='va'>preds</span>,
    check <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>check</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>check</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.485171</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andreas D Soteriades.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


