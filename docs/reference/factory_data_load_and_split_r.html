<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Split dataset into training and test sets — factory_data_load_and_split_r • pxtextmineR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Split dataset into training and test sets — factory_data_load_and_split_r" />
<meta property="og:description" content="Splits the dataset with Scikit-learn
and returns the train/test data and their row/position indices." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pxtextmineR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pxtextmineR-vignette.html">pxtextmineR-vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Split dataset into training and test sets</h1>
    
    <div class="hidden name"><code>factory_data_load_and_split_r.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Splits the dataset with <a href='https://scikit-learn.org/stable/index.html'><code>Scikit-learn</code></a>
and returns the train/test data and their row/position indices.</p>
    </div>

    <pre class="usage"><span class='fu'>factory_data_load_and_split_r</span><span class='op'>(</span>
  <span class='va'>filename</span>,
  <span class='va'>target</span>,
  <span class='va'>predictor</span>,
  test_size <span class='op'>=</span> <span class='fl'>0.33</span>,
  reduce_criticality <span class='op'>=</span> <span class='cn'>FALSE</span>,
  theme <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>filename</th>
      <td><p>A data frame with the data (class and text columns),
otherwise the dataset name (CSV), including full path to the data folder
(if not in the project's working directory), and the data type suffix
(".csv").</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p>String. The name of the response variable.</p></td>
    </tr>
    <tr>
      <th>predictor</th>
      <td><p>String. The name of the predictor variable.</p></td>
    </tr>
    <tr>
      <th>test_size</th>
      <td><p>Numeric. Proportion of data that will form the test dataset.</p></td>
    </tr>
    <tr>
      <th>reduce_criticality</th>
      <td><p>Logical. For internal use by Nottinghamshire
Healthcare NHS Foundation Trust or other trusts that hold data on
criticality. If <code>TRUE</code>, then all records with a criticality of "-5"
(respectively, "5") are assigned a criticality of "-4" (respectively, "4").
This is to avoid situations where the pipeline breaks due to a lack of
sufficient data for "-5" and/or "5". Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>theme</th>
      <td><p>String. For internal use by Nottinghamshire Healthcare NHS
Foundation Trust or other trusts that use theme labels ("Access",
"Environment/ facilities" etc.). The column name of the theme variable.
Defaults to <code>NULL</code>. If supplied, the theme variable will be used as a
predictor (along with the text predictor) in the model that is fitted
with criticality as the response variable. The rationale is two-fold.
First, to help the model improve predictions on criticality when the
theme labels are readily available. Second, to force the criticality for
"Couldn't be improved" to always be "3" in the training and test data, as
well as in the predictions. This is the only criticality value that
"Couldn't be improved" can take, so by forcing it to always be "3", we
are improving model performance, but are also correcting possible
erroneous assignments of values other than "3" that are attributed to
human error.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of length 6: <code>x_train</code> (data frame), <code>x_test</code> (data frame),
<code>y_train</code> (array), <code>y_test</code> (array), <code>index_training_data</code>
(integer vector), and <code>index_test_data</code> (integer vector). The row names
(names) of <code>x_train</code> and <code>x_test</code> (<code>y_train</code> and <code>y_test</code>) are
<code>index_training_data</code> and <code>index_test_data</code> respectively.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Pedregosa F., Varoquaux G., Gramfort A., Michel V., Thirion B., Grisel O.,
Blondel M., Prettenhofer P., Weiss R., Dubourg V., Vanderplas J., Passos A.,
Cournapeau D., Brucher M., Perrot M. &amp; Duchesnay E. (2011),
<a href='https://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html'>Scikit-learn: Machine Learning in Python</a>.
<em>Journal of Machine Learning Research</em> 12:2825--2830</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>data_splits</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'>factory_data_load_and_split_r</span><span class='op'>(</span>
  filename <span class='op'>=</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='va'><a href='text_data.html'>text_data</a></span>,
  target <span class='op'>=</span> <span class='st'>"label"</span>,
  predictor <span class='op'>=</span> <span class='st'>"feedback"</span>,
  test_size <span class='op'>=</span> <span class='fl'>0.33</span><span class='op'>)</span>

<span class='co'># Let's take a look at the returned list</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>data_splits</span><span class='op'>)</span>
</div><div class='output co'>#&gt; List of 6
#&gt;  $ x_train            :'data.frame':	6923 obs. of  1 variable:
#&gt;   ..$ predictor: chr [1:6923] "EverythIng has been better sInce I have been here." "Very warm - would be nice if there were more fans." "sSaff member was good, thank you." "When told something I would like it to be followed through.  \nHave more TV remotes for the ward.\nHave more st"| __truncated__ ...
#&gt;   ..- attr(*, "pandas.index")=Int64Index([ 3023, 10275,  4863,   419,  4698,  6705,  2596,  9054,  3945,
#&gt;              8862,
#&gt;             ...
#&gt;              1963,  4468,  1263,  3634,  2713,  1802,  2113,  8346,  8247,
#&gt;              6899],
#&gt;            dtype='int64', length=6923)
#&gt;  $ x_test             :'data.frame':	3411 obs. of  1 variable:
#&gt;   ..$ predictor: chr [1:3411] "Everyone Is excellent, staff &amp; therapIsts, cleaners, housekeepers are fabulous. I thought I was the Queen Mothe"| __truncated__ "Communication. " "I just received a telephone assessment a month after desperately seeking advice from the GP. No examination, st"| __truncated__ "The team was on hand and friendly." ...
#&gt;   ..- attr(*, "pandas.index")=Int64Index([3003, 1836, 4159, 5190, 9526, 4427, 6127, 9767,  686, 2630,
#&gt;             ...
#&gt;             4883, 6881, 9161, 9894, 6070, 8641, 4969, 8206, 3533, 8127],
#&gt;            dtype='int64', length=3411)
#&gt;  $ y_train            : chr [1:6923(1d)] "Care received" "Environment/ facilities" "Staff" "Care received" ...
#&gt;   ..- attr(*, "dimnames")=List of 1
#&gt;   .. ..$ : chr [1:6923] "3023" "10275" "4863" "419" ...
#&gt;  $ y_test             : chr [1:3411(1d)] "Care received" "Communication" "Access" "Staff" ...
#&gt;   ..- attr(*, "dimnames")=List of 1
#&gt;   .. ..$ : chr [1:3411] "3003" "1836" "4159" "5190" ...
#&gt;  $ index_training_data: int [1:6923] 3023 10275 4863 419 4698 6705 2596 9054 3945 8862 ...
#&gt;  $ index_test_data    : int [1:3411] 3003 1836 4159 5190 9526 4427 6127 9767 686 2630 ...</div><div class='input'>
<span class='co'># Each record in the split data is tagged with the row index of the original dataset</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>data_splits</span><span class='op'>$</span><span class='va'>x_train</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "3023"  "10275" "4863"  "419"   "4698"  "6705" </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>data_splits</span><span class='op'>$</span><span class='va'>y_train</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "3023"  "10275" "4863"  "419"   "4698"  "6705" </div><div class='input'>
<span class='co'># Note that, in Python, indices start from 0 and go up to number_of_records - 1</span>
<span class='va'>all_indices</span> <span class='op'>&lt;-</span> <span class='va'>data_splits</span><span class='op'>$</span><span class='va'>y_train</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>data_splits</span><span class='op'>$</span><span class='va'>y_test</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>all_indices</span><span class='op'>)</span> <span class='co'># Starts from zero</span>
</div><div class='output co'>#&gt; [1] 0 1 2 3 4 5</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>all_indices</span><span class='op'>)</span> <span class='co'># Ends in nrow(text_data) - 1</span>
</div><div class='output co'>#&gt; [1] 10328 10329 10330 10331 10332 10333</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>all_indices</span><span class='op'>)</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>text_data</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andreas D Soteriades.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


