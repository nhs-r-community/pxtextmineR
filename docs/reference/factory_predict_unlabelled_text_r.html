<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict unlabelled text using a fitted Scikit-learn (Python) pipeline — factory_predict_unlabelled_text_r • pxtextmineR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict unlabelled text using a fitted Scikit-learn (Python) pipeline — factory_predict_unlabelled_text_r" />
<meta property="og:description" content="Predict unlabelled text using a fitted Scikit-learn (Python) pipeline" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pxtextmineR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pxtextmineR-vignette.html">pxtextmineR-vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict unlabelled text using a fitted <code>Scikit-learn</code> (Python) pipeline</h1>
    
    <div class="hidden name"><code>factory_predict_unlabelled_text_r.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predict unlabelled text using a fitted <code>Scikit-learn</code> (Python) pipeline</p>
    </div>

    <pre class="usage"><span class='fu'>factory_predict_unlabelled_text_r</span><span class='op'>(</span>
  <span class='va'>dataset</span>,
  <span class='va'>predictor</span>,
  <span class='va'>pipe_path_or_object</span>,
  preds_column <span class='op'>=</span> <span class='cn'>NULL</span>,
  column_names <span class='op'>=</span> <span class='st'>"all_cols"</span>,
  theme <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataset</th>
      <td><p>Data frame. The text data to predict classes for.</p></td>
    </tr>
    <tr>
      <th>predictor</th>
      <td><p>String. The column name of the text variable.</p></td>
    </tr>
    <tr>
      <th>pipe_path_or_object</th>
      <td><p>String or
<code>sklearn.model_selection._search.RandomizedSearchCV</code> (e.g. from
<code><a href='factory_pipeline_r.html'>factory_pipeline_r</a></code>). If a string, it should be in the form
"path_to_fitted_pipeline/pipeline.sav", where "pipeline" is the name of
the SAV file with the fitted <code>Scikit-learn</code> pipeline.</p></td>
    </tr>
    <tr>
      <th>preds_column</th>
      <td><p>A string with the user-specified name of the column that
will have the predictions. If <code>NULL</code> (default), then the name will be
<code><a href='https://rdrr.io/r/base/paste.html'>paste0(text_col_name, "_preds")</a></code>.</p></td>
    </tr>
    <tr>
      <th>column_names</th>
      <td><p>A vector of strings with the names of the columns of the
supplied data frame (incl. <code>text_col_name</code>) to be added to the returned
data frame. If "preds_only", then the only column in the returned data
frame will be <code>preds_column</code>. Defaults to "all_cols".</p></td>
    </tr>
    <tr>
      <th>theme</th>
      <td><p>String. For internal use by Nottinghamshire Healthcare NHS
Foundation Trust or other trusts that use theme labels ("Access",
"Environment/ facilities" etc.). The column name of the theme variable.
Defaults to <code>NULL</code>. If supplied, the theme variable will be used as a
predictor (along with the text predictor) in the model that is fitted
with criticality as the response variable. The rationale is two-fold.
First, to help the model improve predictions on criticality when the
theme labels are readily available. Second, to force the criticality for
"Couldn't be improved" to always be "3" in the training and test data, as
well as in the predictions. This is the only criticality value that
"Couldn't be improved" can take, so by forcing it to always be "3", we
are improving model performance, but are also correcting possible
erroneous assignments of values other than "3" that are attributed to
human error.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Data frame. The predictions column with or without any other columns
passed by the user (see <code>column_names</code>).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Prepare training and test sets</span>
<span class='va'>data_splits</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'><a href='factory_data_load_and_split_r.html'>factory_data_load_and_split_r</a></span><span class='op'>(</span>
  filename <span class='op'>=</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='va'><a href='text_data.html'>text_data</a></span>,
  target <span class='op'>=</span> <span class='st'>"label"</span>,
  predictor <span class='op'>=</span> <span class='st'>"feedback"</span>,
  test_size <span class='op'>=</span> <span class='fl'>0.90</span><span class='op'>)</span>

<span class='co'># Fit the pipeline</span>
<span class='va'>pipe</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'><a href='factory_pipeline_r.html'>factory_pipeline_r</a></span><span class='op'>(</span>
  x <span class='op'>=</span> <span class='va'>data_splits</span><span class='op'>$</span><span class='va'>x_train</span>,
  y <span class='op'>=</span> <span class='va'>data_splits</span><span class='op'>$</span><span class='va'>y_train</span>,
  tknz <span class='op'>=</span> <span class='st'>"spacy"</span>,
  ordinal <span class='op'>=</span> <span class='cn'>FALSE</span>,
  metric <span class='op'>=</span> <span class='st'>"accuracy_score"</span>,
  cv <span class='op'>=</span> <span class='fl'>2</span>, n_iter <span class='op'>=</span> <span class='fl'>1</span>, n_jobs <span class='op'>=</span> <span class='fl'>1</span>, verbose <span class='op'>=</span> <span class='fl'>3</span>,
  learners <span class='op'>=</span> <span class='st'>"SGDClassifier"</span>
<span class='op'>)</span>

<span class='co'># Make predictions #</span>
<span class='co'># Return data frame with predictions column and all original columns from</span>
<span class='co'># the supplied data frame</span>
<span class='va'>preds_all_cols</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'>factory_predict_unlabelled_text_r</span><span class='op'>(</span>
  dataset <span class='op'>=</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='va'><a href='text_data.html'>text_data</a></span>,
  predictor <span class='op'>=</span> <span class='st'>"feedback"</span>,
  pipe_path_or_object <span class='op'>=</span> <span class='va'>pipe</span>,
  column_names <span class='op'>=</span> <span class='st'>"all_cols"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>preds_all_cols</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 'data.frame':	10334 obs. of  4 variables:
#&gt;  $ feedback_preds: chr  "Couldn't be improved" "Care received" "Staff" "Care received" ...
#&gt;  $ label         : chr  "Couldn't be improved" "Environment/ facilities" "Access" "Communication" ...
#&gt;  $ criticality   : chr  "3" "-1" "-2" "-1" ...
#&gt;  $ feedback      : chr  "Nothing." "Temperature in theatre a little low." "Same service available at Bingham Health Centre." "Appointment details given over phone - no physical evidence/reminder which could cause problems. Other than tha"| __truncated__ ...
#&gt;  - attr(*, "pandas.index")=RangeIndex(start=0, stop=10334, step=1)</div><div class='input'>
<span class='co'># Return data frame with predictions column only</span>
<span class='va'>preds_preds_only</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'>factory_predict_unlabelled_text_r</span><span class='op'>(</span>
  dataset <span class='op'>=</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='va'><a href='text_data.html'>text_data</a></span>,
  predictor <span class='op'>=</span> <span class='st'>"feedback"</span>,
  pipe_path_or_object <span class='op'>=</span> <span class='va'>pipe</span>,
  column_names <span class='op'>=</span> <span class='st'>"preds_only"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>preds_preds_only</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         feedback_preds
#&gt; 1 Couldn't be improved
#&gt; 2        Care received
#&gt; 3                Staff
#&gt; 4        Care received
#&gt; 5        Miscellaneous
#&gt; 6        Care received</div><div class='input'>
<span class='co'># Return data frame with predictions column and columns label and feedback from</span>
<span class='co'># the supplied data frame</span>
<span class='va'>preds_label_text</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'>factory_predict_unlabelled_text_r</span><span class='op'>(</span>
  dataset <span class='op'>=</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='va'><a href='text_data.html'>text_data</a></span>,
  predictor <span class='op'>=</span> <span class='st'>"feedback"</span>,
  pipe_path_or_object <span class='op'>=</span> <span class='va'>pipe</span>,
  column_names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"label"</span>, <span class='st'>"feedback"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>preds_label_text</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 'data.frame':	10334 obs. of  3 variables:
#&gt;  $ feedback_preds: chr  "Couldn't be improved" "Care received" "Staff" "Care received" ...
#&gt;  $ label         : chr  "Couldn't be improved" "Environment/ facilities" "Access" "Communication" ...
#&gt;  $ feedback      : chr  "Nothing." "Temperature in theatre a little low." "Same service available at Bingham Health Centre." "Appointment details given over phone - no physical evidence/reminder which could cause problems. Other than tha"| __truncated__ ...
#&gt;  - attr(*, "pandas.index")=RangeIndex(start=0, stop=10334, step=1)</div><div class='input'>
<span class='co'># Return data frame with the predictions column name supplied by the user</span>
<span class='va'>preds_custom_preds_name</span> <span class='op'>&lt;-</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='fu'>factory_predict_unlabelled_text_r</span><span class='op'>(</span>
  dataset <span class='op'>=</span> <span class='fu'>pxtextmineR</span><span class='fu'>::</span><span class='va'><a href='text_data.html'>text_data</a></span>,
  predictor <span class='op'>=</span> <span class='st'>"feedback"</span>,
  pipe_path_or_object <span class='op'>=</span> <span class='va'>pipe</span>,
  column_names <span class='op'>=</span> <span class='st'>"preds_only"</span>,
  preds_column <span class='op'>=</span> <span class='st'>"predictions"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>preds_custom_preds_name</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            predictions
#&gt; 1 Couldn't be improved
#&gt; 2        Care received
#&gt; 3                Staff
#&gt; 4        Care received
#&gt; 5        Miscellaneous
#&gt; 6        Care received</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andreas D Soteriades.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


